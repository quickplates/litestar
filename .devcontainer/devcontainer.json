{
  "build": {
    "context": "image/",
    "dockerfile": "image/Dockerfile",
    "options": ["--network=host"]
  },
  "customizations": {
    "vscode": {
      "extensions": [
        "jnoortheen.nix-ide",
        "mkhl.direnv",
        "ms-python.python",
        "samuelcolvin.jinjahtml",
        "tamasfe.even-better-toml",
        "task.vscode-task",
        "Trunk.io"
      ],
      "settings": {
        "[nix]": {
          "editor.defaultFormatter": "jnoortheen.nix-ide"
        },
        "editor.defaultFormatter": "trunk.io",
        "files.associations": {
          "*.Dockerfile*.jinja": "jinja-dockerfile",
          "*.Dockerfile.jinja": "jinja-dockerfile",
          "*.automount*.jinja": "jinja-systemd",
          "*.bash*.jinja": "jinja-shell",
          "*.bash.jinja": "jinja-shell",
          "*.bash_aliases*.jinja": "jinja-shell",
          "*.bash_aliases.jinja": "jinja-shell",
          "*.bash_login*.jinja": "jinja-shell",
          "*.bash_login.jinja": "jinja-shell",
          "*.bash_logout*.jinja": "jinja-shell",
          "*.bash_logout.jinja": "jinja-shell",
          "*.bash_profile*.jinja": "jinja-shell",
          "*.bash_profile.jinja": "jinja-shell",
          "*.bashrc*.jinja": "jinja-shell",
          "*.bashrc.jinja": "jinja-shell",
          "*.c*.jinja": "jinja-cpp",
          "*.cfg*.jinja": "jinja-properties",
          "*.cfg.jinja": "jinja-properties",
          "*.cisco*.jinja": "jinja-cisco",
          "*.conf*.jinja": "jinja-properties",
          "*.conf.jinja": "jinja-properties",
          "*.cpp*.jinja": "jinja-cpp",
          "*.css*.jinja": "jinja-css",
          "*.desktop*.jinja": "jinja-properties",
          "*.desktop.jinja": "jinja-properties",
          "*.device*.jinja": "jinja-systemd",
          "*.directory*.jinja": "jinja-properties",
          "*.directory.jinja": "jinja-properties",
          "*.ebuild*.jinja": "jinja-shell",
          "*.ebuild.jinja": "jinja-shell",
          "*.envrc*.jinja": "jinja-shell",
          "*.envrc.jinja": "jinja-shell",
          "*.groovy*.jinja": "jinja-groovy",
          "*.h*.jinja": "jinja-cpp",
          "*.hcl*.jinja": "jinja-terraform",
          "*.html*.jinja": "jinja-html",
          "*.html.jinja": "jinja-html",
          "*.ini*.jinja": "jinja-properties",
          "*.ini.jinja": "jinja-properties",
          "*.install*.jinja": "jinja-shell",
          "*.install.jinja": "jinja-shell",
          "*.ios*.jinja": "jinja-cisco",
          "*.java*.jinja": "jinja-java",
          "*.json*.jinja": "jinja-json",
          "*.ksh*.jinja": "jinja-shell",
          "*.ksh.jinja": "jinja-shell",
          "*.latex*.jinja": "jinja-latex",
          "*.link*.jinja": "jinja-systemd",
          "*.lua*.jinja": "jinja-lua",
          "*.md*.jinja": "jinja-md",
          "*.mount*.jinja": "jinja-systemd",
          "*.netdev*.jinja": "jinja-systemd",
          "*.network*.jinja": "jinja-systemd",
          "*.path*.jinja": "jinja-systemd",
          "*.php*.jinja": "jinja-php",
          "*.profile*.jinja": "jinja-shell",
          "*.profile.jinja": "jinja-shell",
          "*.properties*.jinja": "jinja-properties",
          "*.properties.jinja": "jinja-properties",
          "*.pxd*.jinja": "jinja-cy",
          "*.pxi*.jinja": "jinja-cy",
          "*.py*.jinja": "jinja-py",
          "*.pyi*.jinja": "jinja-py",
          "*.pyx*.jinja": "jinja-cy",
          "*.rs*.jinja": "jinja-rust",
          "*.scope*.jinja": "jinja-systemd",
          "*.service*.jinja": "jinja-systemd",
          "*.sh*.jinja": "jinja-shell",
          "*.sh.jinja": "jinja-shell",
          "*.slice*.jinja": "jinja-systemd",
          "*.snapshot*.jinja": "jinja-systemd",
          "*.socket*.jinja": "jinja-systemd",
          "*.sql*.jinja": "jinja-sql",
          "*.swap*.jinja": "jinja-systemd",
          "*.target*.jinja": "jinja-systemd",
          "*.tex*.jinja": "jinja-latex",
          "*.tf*.jinja": "jinja-terraform",
          "*.tfvars*.jinja": "jinja-terraform",
          "*.timer*.jinja": "jinja-systemd",
          "*.toml*.jinja": "jinja-toml",
          "*.xml*.jinja": "jinja-xml",
          "*.yaml*.jinja": "jinja-yaml",
          "*.yml*.jinja": "jinja-yaml",
          "*.zlogin*.jinja": "jinja-shell",
          "*.zlogin.jinja": "jinja-shell",
          "*.zlogout*.jinja": "jinja-shell",
          "*.zlogout.jinja": "jinja-shell",
          "*.zprofile*.jinja": "jinja-shell",
          "*.zprofile.jinja": "jinja-shell",
          "*.zsh*.jinja": "jinja-shell",
          "*.zsh-theme*.jinja": "jinja-shell",
          "*.zsh-theme.jinja": "jinja-shell",
          "*.zsh.jinja": "jinja-shell",
          "*.zshenv*.jinja": "jinja-shell",
          "*.zshenv.jinja": "jinja-shell",
          "*.zshrc*.jinja": "jinja-shell",
          "*.zshrc.jinja": "jinja-shell",
          "*_copier_conf.answers_file*.jinja": "jinja-yaml"
        },
        "nix.enableLanguageServer": true,
        "nix.serverPath": "nil",
        "nix.serverSettings": {
          "nil": {
            "formatting": {
              "command": ["nix", "fmt", "--", "-"]
            }
          }
        },
        "python.analysis.nodeExecutable": "auto",
        "remote.autoForwardPorts": false
      }
    }
  },
  "features": {
    "ghcr.io/devcontainers-extra/features/direnv:1.0.3": {
      "version": "2.37.1"
    },
    "ghcr.io/devcontainers-extra/features/starship:1.0.10": {
      "version": "1.24.0"
    },
    "ghcr.io/devcontainers/features/docker-in-docker:2.12.4": {
      "version": "28.5.1"
    },
    "ghcr.io/devcontainers/features/nix:1.2.0": {
      "extraNixConfig": "experimental-features = nix-command flakes",
      "version": "2.28.5"
    }
  },
  "mounts": [
    "source=devcontainer-shared-secrets,target=/secrets/,type=volume",
    "source=devcontainer-${devcontainerId}-nix,target=/nix/,type=volume",
    "source=devcontainer-${devcontainerId}-shellhistory-persist,target=/persist/shellhistory/,type=volume",
    "source=devcontainer-shared-trunk-cache,target=/cache/trunk/,type=volume",
    "source=devcontainer-shared-uv-cache,target=/cache/uv/,type=volume",
    "source=devcontainer-shared-npm-cache,target=/cache/npm/,type=volume"
  ],
  "onCreateCommand": "/hooks/create.sh",
  "remoteEnv": {
    "WORKSPACE": "${containerWorkspaceFolder}"
  },
  "runArgs": [
    "--uts=host",
    "--ipc=host",
    "--network=host",
    "--userns=host",
    "--cgroupns=host",
    "--privileged"
  ]
}
